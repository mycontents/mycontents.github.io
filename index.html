<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contents</title>

  <!-- Tailwind (required) -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

  <link rel="stylesheet" href="styles.css" />
  <script src="app.js" defer></script>
</head>

<body>
  <div class="container" id="container">
    <header>
      <div class="header-row">
        <button class="section-btn" id="sectionBtn" onclick="toggleSectionMenu()">
          <span id="currentSectionName">Все</span>
          <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-chevron-down"></use></svg>
        </button>

        <!-- toggle only for "Все": include/exclude viewed sections -->
        <button class="all-toggle hidden" id="viewedToggleBtn" onclick="toggleShowViewed()" title="Показывать/скрывать просмотренное">
          <svg class="icon" viewBox="0 0 16 16"><use id="viewedToggleUse" href="icons.svg#i-eye-off"></use></svg>
        </button>

        <div class="filter-wrap" title="Фильтр">
          <input class="filter-input" id="filterInput" placeholder="Фильтр" autocapitalize="off" autocomplete="off" spellcheck="false" />
          <button class="filter-clear hidden" id="filterClear" title="Очистить фильтр" onclick="clearFilter()">
            <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-x"></use></svg>
          </button>
        </div>

        <div class="header-buttons">
          <button class="icon-btn" id="sortBtn" onclick="toggleSort()" title="Сортировка">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-sort"></use></svg>
          </button>

          <button class="icon-btn" id="editBtn" onclick="toggleEdit()" title="Редактировать">
            <svg class="icon" viewBox="0 0 16 16"><use id="editUse" href="icons.svg#i-pencil"></use></svg>
          </button>

          <button class="icon-btn" id="settingsBtn" onclick="toggleSettings()" title="Настройки">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-gear"></use></svg>
          </button>
        </div>
      </div>
    </header>

    <div class="content-area">
      <div class="content-list" id="viewMode"></div>

      <div class="hidden" id="editMode">
        <div class="edit-hint hidden" id="editHint">[Раздел] Текст (для просмотренного: [~Раздел] Текст)</div>
        <textarea class="content-edit" id="editor" placeholder="..."></textarea>
        <div class="edit-panel">
          <button class="btn-cancel" onclick="cancelEdit()" title="Отмена">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-x"></use></svg>
          </button>
          <button class="btn-save" onclick="saveEdit()" title="Сохранить">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-check"></use></svg>
          </button>
        </div>
      </div>

      <div class="counter" id="counter"></div>
    </div>

    <!-- Sections -->
    <div class="dropdown-menu section-menu hidden" id="sectionMenu">
      <div class="menu-option all-sections" onclick="selectSection('__all__')">Все</div>
      <div id="sectionList"></div>
      <div class="menu-divider"></div>
      <div class="menu-option add-new" onclick="showNewSectionInput()">+ Новый</div>
      <input
        type="text"
        class="new-section-input hidden"
        id="newSectionInput"
        placeholder="Название..."
        onkeydown="handleNewSection(event)"
      />
    </div>

    <!-- Sort -->
    <div class="dropdown-menu sort-menu hidden" id="sortMenu">
      <div class="menu-option" data-key="manual" onclick="setSortKey('manual')">
        Вручную <span class="sort-dir"></span>
      </div>
      <div class="menu-option" data-key="date" onclick="setSortKey('date')">
        Дата <span class="sort-dir"></span>
      </div>
      <div class="menu-option" data-key="alpha" onclick="setSortKey('alpha')">
        А-Я <span class="sort-dir"></span>
      </div>
      <div class="menu-option" data-key="year" onclick="setSortKey('year')">
        Год <span class="sort-dir"></span>
      </div>
    </div>

    <!-- Settings -->
    <div class="dropdown-menu settings-menu hidden" id="settingsMenu">
      <label>Gist ID</label>
      <input type="text" id="inputGistId" placeholder="abc123..." />

      <label>Token</label>
      <input type="password" id="inputToken" placeholder="ghp_..." />

      <div class="settings-buttons">
        <button class="settings-btn btn-primary" onclick="saveSettings()" title="Применить">
          <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-check"></use></svg>
        </button>
        <button class="settings-btn btn-share" onclick="copyShareLink()" id="shareBtn" title="Скопировать ссылку">
          <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-copy"></use></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Undo bar -->
  <div class="undo-bar hidden" id="undoBar">
    <div class="undo-text" id="undoText"></div>
    <button class="undo-btn" id="undoBtn" title="Отменить">
      <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-undo"></use></svg>
    </button>
  </div>
</body>
</html>
