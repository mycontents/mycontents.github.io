<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, interactive-widget=resizes-content" />
  <title>–ö–æ–Ω—Ç–µ–Ω—Ç</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé¨</text></svg>">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <link rel="stylesheet" href="styles.css?v=2026-01-24-12" />
  <script src="app.js?v=2026-01-24-12" defer></script>
</head>
<body>
  <div class="container" id="container">
    <header>
      <div class="header-row">
        <div class="header-left">
          <button class="section-btn" id="sectionBtn" onclick="toggleSectionMenu()">
            <span id="currentSectionName">–í—Å–µ</span>
            <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-chevron-down"></use></svg>
          </button>
          <button class="view-toggle" id="viewedToggleBtn" onclick="cycleViewedFilter()" title="–§–∏–ª—å—Ç—Ä –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–≥–æ">
            <svg class="icon" viewBox="0 0 16 16"><use id="viewedToggleUse" href="icons.svg#i-eye-off"></use></svg>
          </button>
        </div>
        <div class="header-right">
          <button class="icon-btn" id="tagFilterBtn" onclick="toggleTagFilterMenu()" title="–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-tag"></use></svg>
          </button>
          <button class="search-toggle-btn" id="searchToggleBtn" onclick="toggleMobileSearch()" title="–ü–æ–∏—Å–∫">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-search"></use></svg>
          </button>
          <div class="filter-wrap" id="filterWrap">
            <input class="filter-input" id="filterInput" placeholder="–§–∏–ª—å—Ç—Ä" autocapitalize="off" autocomplete="off" spellcheck="false" />
            <span class="filter-counter" id="filterCounter"></span>
            <button class="filter-clear hidden" id="filterClear" onclick="clearFilter()">
              <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-x"></use></svg>
            </button>
          </div>
          <button class="icon-btn" id="sortBtn" onclick="toggleSort()" title="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-sort"></use></svg>
          </button>
          <button class="icon-btn" id="editBtn" onclick="toggleEdit()" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
            <svg class="icon" viewBox="0 0 16 16"><use id="editUse" href="icons.svg#i-pencil"></use></svg>
          </button>
        </div>
      </div>
      <div class="mobile-search-row hidden" id="mobileSearchRow">
        <div class="filter-wrap mobile-filter">
          <input class="filter-input" id="mobileFilterInput" placeholder="–§–∏–ª—å—Ç—Ä" autocapitalize="off" autocomplete="off" spellcheck="false" />
          <span class="filter-counter" id="mobileFilterCounter"></span>
          <button class="filter-clear hidden" id="mobileFilterClear" onclick="clearFilter()">
            <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-x"></use></svg>
          </button>
        </div>
      </div>
    </header>

    <div class="content-area">
      <div class="content-list" id="viewMode"></div>
      <div class="hidden" id="editMode">
        <div class="edit-hint hidden" id="editHint">[–†–∞–∑–¥–µ–ª] –¢–µ–∫—Å—Ç</div>
        <textarea class="content-edit" id="editor" placeholder="..."></textarea>
        <div class="edit-panel">
          <button class="btn-cancel" onclick="cancelEdit()">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-x"></use></svg>
          </button>
          <button class="btn-tmdb-mode" id="tmdbModeBtn" onclick="cycleTmdbMode()" title="–ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ TMDB">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-doc"></use></svg>
          </button>
          <button class="btn-save" onclick="saveEdit()">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-check"></use></svg>
          </button>
        </div>
      </div>
    </div>

    <div class="scroll-slack" id="scrollSlackBottom" aria-hidden="true"></div>

    <!-- Sections menu -->
    <div class="dropdown-menu section-menu hidden" id="sectionMenu">
      <div class="menu-option all-sections-row">
        <span onclick="selectSection('__all__')">–í—Å–µ</span>
        <button class="add-section-btn" onclick="showNewSectionInput()" title="–ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª">+</button>
      </div>
      <input type="text" class="new-section-input hidden" id="newSectionInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ..." onkeydown="handleNewSection(event)" />
      <div id="sectionList"></div>
      <div class="menu-divider"></div>
      <div class="menu-option" onclick="toggleSettingsPanel()">
        <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-gear"></use></svg>
        <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</span>
      </div>
      <div class="settings-panel hidden" id="settingsPanel">
        <label>Gist ID</label>
        <input type="text" id="inputGistId" placeholder="abc123..." />
        <label>GitHub Token (classic)</label>
        <input type="password" id="inputToken" placeholder="ghp_..." />
        <label>TMDB API Key</label>
        <input type="password" id="inputTmdbKey" placeholder="a1b2c3d4..." />
        <div class="settings-buttons">
          <button class="settings-btn btn-primary" onclick="saveSettings()">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-check"></use></svg>
          </button>
          <button class="settings-btn btn-share" onclick="copyShareLink()" id="shareBtn">
            <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-copy"></use></svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Sort menu -->
    <div class="dropdown-menu sort-menu hidden" id="sortMenu">
      <div class="menu-option" data-key="manual" onclick="setSortKey('manual')">–í—Ä—É—á–Ω—É—é <span class="sort-dir"></span></div>
      <div class="menu-option" data-key="date" onclick="setSortKey('date')">–î–∞—Ç–∞ <span class="sort-dir"></span></div>
      <div class="menu-option" data-key="alpha" onclick="setSortKey('alpha')">–ê-–Ø <span class="sort-dir"></span></div>
      <div class="menu-option" data-key="year" onclick="setSortKey('year')">–ì–æ–¥ <span class="sort-dir"></span></div>
    </div>

    <!-- Tag filter menu -->
    <div class="dropdown-menu tag-filter-menu hidden" id="tagFilterMenu">
      <div class="tag-menu-head">
        <div class="tag-menu-title">–¢–µ–≥–∏</div>
        <button class="mini-btn" onclick="clearTagFilter()" title="–°–±—Ä–æ—Å–∏—Ç—å">
          <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-x"></use></svg>
        </button>
      </div>
      <div class="tag-menu-list" id="tagFilterList"></div>

      <div class="menu-divider"></div>
      <div class="tag-menu-title rating-title">–†–µ–π—Ç–∏–Ω–≥</div>
      <div class="rating-grid" id="ratingFilterList"></div>

      <div class="tag-menu-hint" id="tagFilterHint"></div>
    </div>

    <!-- Move to section menu -->
    <div class="dropdown-menu move-menu hidden" id="moveMenu">
      <div class="move-menu-title">–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª</div>
      <div class="move-section-list" id="moveSectionList"></div>
      <div class="move-new-section">
        <input type="text" class="move-new-input" id="moveNewInput" placeholder="–ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª..." />
        <button class="mini-btn" id="moveNewOkBtn" onclick="confirmMoveToNewSection()" title="–°–æ–∑–¥–∞—Ç—å –∏ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏">
          <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-check"></use></svg>
        </button>
      </div>
    </div>

    <!-- Tag editor menu -->
    <div class="dropdown-menu tag-editor-menu hidden" id="tagEditorMenu">
      <div class="tag-menu-head">
        <button class="mini-btn tmdb-btn" id="tmdbBtn" onclick="fetchTmdbTags()" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ TMDB">
          <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-download"></use></svg>
        </button>
        <div class="tag-menu-title" id="tagEditorTitle">–¢–µ–≥–∏</div>
        <button class="mini-btn" onclick="clearTagsForCurrentItem()" title="–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ">
          <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-trash"></use></svg>
        </button>
      </div>

      <!-- TMDB pick list (shown only when multiple matches found) -->
      <div class="tmdb-pick hidden" id="tmdbPick"></div>

      <div class="tag-add-row">
        <input class="tag-add-input" id="tagAddInput" placeholder="–î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥..." autocomplete="off" spellcheck="false" onkeydown="handleTagAdd(event)" />
        <button class="mini-btn" onclick="addTagFromInput()" title="–î–æ–±–∞–≤–∏—Ç—å">
          <svg class="icon small" viewBox="0 0 16 16"><use href="icons.svg#i-check"></use></svg>
        </button>
      </div>
      <div class="tag-menu-list" id="tagEditorList"></div>
    </div>

  </div>

  <div class="undo-bar hidden" id="undoBar">
    <div class="undo-text" id="undoText"></div>
    <button class="undo-btn" id="undoBtn">
      <svg class="icon" viewBox="0 0 16 16"><use href="icons.svg#i-undo"></use></svg>
    </button>
  </div>

  <div class="progress-bar hidden" id="progressBar">
    <div class="progress-fill" id="progressFill"></div>
    <div class="progress-text" id="progressText"></div>
  </div>
</body>
</html>
